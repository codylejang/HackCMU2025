{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/hyunwooyi/Documents/Projects/HackCMU2025/src/app/reader/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect, use, useMemo, useCallback, memo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  ArrowLeft, \n  MessageCircle, \n  Settings, \n  BookOpen, \n  ChevronDown,\n  ChevronUp,\n  Send,\n  X,\n  History,\n  Bot,\n  User\n} from 'lucide-react';\nimport Link from 'next/link';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\n\ninterface ChatMessage {\n  id: string;\n  type: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n  references?: string[];\n}\n\ninterface Reference {\n  id: string;\n  content: string;\n  page?: number;\n  chapter?: string;\n}\n\ninterface ContentChunk {\n  id: string;\n  content: string;\n  page: number;\n  chapter?: string;\n}\n\nconst CHUNK_SIZE = 2000; // Characters per chunk (increased for better space utilization)\nconst CHUNKS_PER_PAGE = 1; // One chunk per section for single screen fit\n\n// Memoized chat message component\nconst ChatMessageComponent = memo(({ \n  message, \n  showReferences, \n  references, \n  onToggleReferences \n}: {\n  message: ChatMessage;\n  showReferences: string | null;\n  references: Record<string, Reference[]>;\n  onToggleReferences: (messageId: string) => void;\n}) => (\n  <motion.div\n    initial={{ opacity: 0, y: 20 }}\n    animate={{ opacity: 1, y: 0 }}\n    className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}\n  >\n    <div className={`max-w-xs px-4 py-2 rounded-lg ${\n      message.type === 'user' \n        ? 'bg-amber-600 text-white' \n        : 'bg-gray-100 text-gray-900'\n    }`}>\n      <div className=\"flex items-start space-x-2\">\n        {message.type === 'assistant' && (\n          <Bot className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\n        )}\n        {message.type === 'user' && (\n          <User className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\n        )}\n        <div className=\"flex-1\">\n          <p className=\"text-sm\">{message.content}</p>\n          {message.references && message.references.length > 0 && (\n            <div className=\"mt-2 flex items-center space-x-2\">\n              <button\n                onClick={() => onToggleReferences(message.id)}\n                className=\"text-xs underline hover:no-underline\"\n              >\n                {showReferences === message.id ? 'Hide' : 'Show'} References ({message.references.length})\n              </button>\n              <Link href={`/qa/${message.id}`}>\n                <button className=\"text-xs text-amber-600 hover:text-amber-700 font-medium\">\n                  View Full Answer\n                </button>\n              </Link>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  </motion.div>\n));\n\nChatMessageComponent.displayName = 'ChatMessageComponent';\n\nexport default function ReaderPage({ params }: { params: Promise<{ id: string }> }) {\n  const { id } = use(params);\n  const [isChatOpen, setIsChatOpen] = useState(false);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [chatMessages, setChatMessages] = useState<ChatMessage[]>([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showReferences, setShowReferences] = useState<string | null>(null);\n  const [references, setReferences] = useState<Record<string, Reference[]>>({});\n  const [bookContent, setBookContent] = useState<string>('');\n  const [contentChunks, setContentChunks] = useState<ContentChunk[]>([]);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [bookMetadata, setBookMetadata] = useState<any>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\n  const [showPageSelector, setShowPageSelector] = useState(false);\n  const [pageInput, setPageInput] = useState('');\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n  \n  const chatInputRef = useRef<HTMLInputElement>(null);\n  const chatContainerRef = useRef<HTMLDivElement>(null);\n\n  // Save current page when component unmounts or page unloads\n  useEffect(() => {\n    const saveCurrentPage = () => {\n      if (id && currentPage > 0 && totalPages > 0 && !isInitialLoad) {\n        console.log('Saving page on exit:', { id, currentPage });\n        // Use sendBeacon for more reliable saving on page unload\n        const data = JSON.stringify({ currentPage });\n        if (navigator.sendBeacon) {\n          navigator.sendBeacon(`/api/books/${id}/current-page`, data);\n        } else {\n          fetch(`/api/books/${id}/current-page`, {\n            method: 'PUT',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: data,\n          }).catch(error => {\n            console.error('Error saving current page on exit:', error);\n          });\n        }\n      }\n    };\n\n    // Save on page unload\n    const handleBeforeUnload = () => {\n      saveCurrentPage();\n    };\n\n    window.addEventListener('beforeunload', handleBeforeUnload);\n\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n      // Also save on component unmount\n      saveCurrentPage();\n    };\n  }, [id, currentPage, totalPages, isInitialLoad]);\n\n  // Debug currentPage changes\n  useEffect(() => {\n    console.log('currentPage changed to:', currentPage);\n  }, [currentPage]);\n\n  // Auto-scroll chat to bottom when new messages arrive\n  useEffect(() => {\n    if (chatContainerRef.current) {\n      chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;\n    }\n  }, [chatMessages]);\n\n  // Extract chapter title from content\n  const extractChapterTitle = useCallback((content: string): string | undefined => {\n    const lines = content.split('\\n');\n    for (const line of lines) {\n      // Look for main chapter headings (H1) but exclude book titles\n      if (line.startsWith('# ')) {\n        const title = line.replace('# ', '').trim();\n        // Skip if it looks like a book title or is too generic\n        const lowerTitle = title.toLowerCase();\n        if (title.length > 10 && \n            !lowerTitle.includes('steve jobs') && \n            !lowerTitle.includes('biography') &&\n            !lowerTitle.includes('by walter isaacson') &&\n            !lowerTitle.includes('table of contents') &&\n            !lowerTitle.includes('introduction') &&\n            !lowerTitle.includes('preface') &&\n            !lowerTitle.includes('acknowledgments') &&\n            !lowerTitle.includes('notes') &&\n            !lowerTitle.includes('index')) {\n          return title;\n        }\n      }\n    }\n    return undefined;\n  }, []);\n\n  // Utility function to chunk content\n  const chunkContent = useCallback((content: string): ContentChunk[] => {\n    const chunks: ContentChunk[] = [];\n    const lines = content.split('\\n');\n    let currentChunk = '';\n    let chunkIndex = 0;\n    let pageNumber = 1;\n    let currentChapter = '';\n    let isInTOC = false;\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i];\n      const potentialChunk = currentChunk + (currentChunk ? '\\n' : '') + line;\n\n      // Check if we're in table of contents section (only for first few pages)\n      if (pageNumber <= 5 && (\n          line.toLowerCase().includes('table of contents') || \n          line.toLowerCase().includes('contents') ||\n          (line.toLowerCase().includes('chapter') && line.length < 100) ||\n          (line.toLowerCase().includes('part') && line.length < 100) ||\n          (line.startsWith('#') && (line.toLowerCase().includes('chapter') || line.toLowerCase().includes('part'))) ||\n          (line.match(/^\\d+\\./) && line.length < 100))) { // Numbered list items that are likely TOC entries\n        isInTOC = true;\n      }\n      \n      // Reset TOC detection after page 5 or when we encounter actual content\n      if (pageNumber > 5 || (line.startsWith('#') && line.length > 20 && !line.toLowerCase().includes('chapter') && !line.toLowerCase().includes('part'))) {\n        isInTOC = false;\n      }\n\n      // Check if this line is a chapter heading\n      if (line.startsWith('# ')) {\n        const title = line.replace('# ', '').trim();\n        // Only update currentChapter if it's a real chapter (not book title)\n        const lowerTitle = title.toLowerCase();\n        if (title.length > 10 && \n            !lowerTitle.includes('steve jobs') && \n            !lowerTitle.includes('biography') &&\n            !lowerTitle.includes('by walter isaacson') &&\n            !lowerTitle.includes('table of contents') &&\n            !lowerTitle.includes('introduction') &&\n            !lowerTitle.includes('preface') &&\n            !lowerTitle.includes('acknowledgments') &&\n            !lowerTitle.includes('notes') &&\n            !lowerTitle.includes('index')) {\n          currentChapter = title;\n        }\n      }\n\n      // Use different chunk sizes based on content type and page number\n      let currentChunkSize;\n      if (isInTOC || pageNumber <= 5) {\n        currentChunkSize = CHUNK_SIZE * 0.3; // 30% for first 5 pages and TOC\n      } else {\n        currentChunkSize = CHUNK_SIZE; // Full chunk size for all non-TOC pages\n      }\n\n      // Check if adding this line would exceed chunk size\n      if (potentialChunk.length > currentChunkSize && currentChunk) {\n        // For TOC, try to break at line boundaries to preserve complete entries\n        if (isInTOC) {\n          const lastNewline = currentChunk.lastIndexOf('\\n');\n          if (lastNewline > currentChunkSize * 0.8) { // If we have a good line break\n            const chunkContent = currentChunk.substring(0, lastNewline).trim();\n            const chapterTitle = extractChapterTitle(chunkContent);\n            chunks.push({\n              id: `chunk_${chunkIndex}`,\n              content: chunkContent,\n              page: pageNumber,\n              chapter: chapterTitle || (currentChapter && currentChapter !== 'Steve Jobs' ? currentChapter : undefined)\n            });\n            currentChunk = currentChunk.substring(lastNewline + 1) + (line ? '\\n' + line : '');\n          } else {\n            // Save current chunk as is\n            const chapterTitle = extractChapterTitle(currentChunk);\n            chunks.push({\n              id: `chunk_${chunkIndex}`,\n              content: currentChunk,\n              page: pageNumber,\n              chapter: chapterTitle || (currentChapter && currentChapter !== 'Steve Jobs' ? currentChapter : undefined)\n            });\n            currentChunk = line;\n          }\n        } else {\n          // Try to break at a paragraph boundary if possible\n          const lastParagraphBreak = currentChunk.lastIndexOf('\\n\\n');\n          if (lastParagraphBreak > currentChunkSize * 0.7) { // If we have a good paragraph break\n            const chunkContent = currentChunk.substring(0, lastParagraphBreak).trim();\n            const chapterTitle = extractChapterTitle(chunkContent);\n            chunks.push({\n              id: `chunk_${chunkIndex}`,\n              content: chunkContent,\n              page: pageNumber,\n              chapter: chapterTitle || (currentChapter && currentChapter !== 'Steve Jobs' ? currentChapter : undefined)\n            });\n            currentChunk = currentChunk.substring(lastParagraphBreak + 2) + (line ? '\\n' + line : '');\n          } else {\n            // Save current chunk as is\n            const chapterTitle = extractChapterTitle(currentChunk);\n            chunks.push({\n              id: `chunk_${chunkIndex}`,\n              content: currentChunk,\n              page: pageNumber,\n              chapter: chapterTitle || (currentChapter && currentChapter !== 'Steve Jobs' ? currentChapter : undefined)\n            });\n            currentChunk = line;\n          }\n        }\n        \n        chunkIndex++;\n        pageNumber++; // Each chunk is now one section\n      } else {\n        currentChunk = potentialChunk;\n      }\n    }\n\n    // Add the last chunk if it exists\n    if (currentChunk.trim()) {\n      const chapterTitle = extractChapterTitle(currentChunk);\n      chunks.push({\n        id: `chunk_${chunkIndex}`,\n        content: currentChunk,\n        page: pageNumber,\n        chapter: chapterTitle || (currentChapter && currentChapter !== 'Steve Jobs' ? currentChapter : undefined)\n      });\n    }\n\n    return chunks;\n  }, [extractChapterTitle]);\n\n  // Load book content from API\n  useEffect(() => {\n    const loadBook = async () => {\n      setIsProcessing(true);\n      try {\n        // Optimize: Only fetch the specific book instead of all books\n        const response = await fetch(`/api/books/${id}`);\n        if (response.ok) {\n          const data = await response.json();\n          if (data.success) {\n            const book = data.data;\n            setBookMetadata(book);\n            setBookContent(book.content || 'No content available');\n            \n            // Chunk the content for better performance\n            const chunks = chunkContent(book.content || '');\n            setContentChunks(chunks);\n            setTotalPages(chunks.length);\n\n            // Open directly at the saved current page\n            console.log('Book loaded:', { \n              bookId: book.id, \n              currentPage: book.currentPage, \n              chunksLength: chunks.length,\n              title: book.title,\n              currentPageType: typeof book.currentPage\n            });\n            \n            if (book.currentPage && book.currentPage >= 1 && book.currentPage <= chunks.length) {\n              console.log('Setting currentPage to saved page:', book.currentPage);\n              setCurrentPage(book.currentPage);\n            } else {\n              console.log('Setting currentPage to 1 (fallback) - currentPage:', book.currentPage, 'chunksLength:', chunks.length);\n              setCurrentPage(1); // Fallback to page 1 if no valid saved page\n            }\n            \n            // Mark initial load as complete\n            setIsInitialLoad(false);\n          }\n        } else {\n          // Fallback: fetch all books if specific book endpoint doesn't exist\n          const response = await fetch('/api/books');\n          const data = await response.json();\n          if (data.success) {\n            const book = data.data.find((b: any) => b.id === id);\n            if (book) {\n              setBookMetadata(book);\n              setBookContent(book.content || 'No content available');\n              \n              // Chunk the content for better performance\n              const chunks = chunkContent(book.content || '');\n              setContentChunks(chunks);\n              setTotalPages(chunks.length);\n\n              // Open directly at the saved current page\n              if (book.currentPage && book.currentPage >= 1 && book.currentPage <= chunks.length) {\n                setCurrentPage(book.currentPage);\n              } else {\n                setCurrentPage(1); // Fallback to page 1 if no valid saved page\n              }\n              \n              // Mark initial load as complete\n              setIsInitialLoad(false);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error loading book:', error);\n        // Fallback to mock content\n        const mockContent = `\n# Chapter 1: The Beginning\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.\n\nDuis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\n\n## Section 1.1: The Journey Begins\n\nSed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.\n\nNemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.\n\n## Section 1.2: The First Challenge\n\nAt vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.\n\nSimilique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio.\n\n# Chapter 2: The Middle\n\nNam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus.\n\nTemporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae.\n\n## Section 2.1: The Plot Thickens\n\nItaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat.\n\nSed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.\n\n## Section 2.2: The Revelation\n\nNemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.\n\nNeque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.\n\n# Chapter 3: The End\n\nUt enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur.\n\nAt vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.\n\n## Section 3.1: The Final Battle\n\nSimilique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio.\n\nNam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus.\n\n## Section 3.2: The Resolution\n\nTemporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae.\n\nItaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat.\n        `.trim();\n        setBookContent(mockContent);\n        const chunks = chunkContent(mockContent);\n        setContentChunks(chunks);\n        setTotalPages(Math.ceil(chunks.length / CHUNKS_PER_PAGE));\n      } finally {\n        setIsProcessing(false);\n      }\n    };\n\n    loadBook();\n  }, [id, chunkContent]);\n\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim() || isLoading) return;\n\n    const userMessage: ChatMessage = {\n      id: Date.now().toString(),\n      type: 'user',\n      content: inputMessage,\n      timestamp: new Date(),\n    };\n\n    setChatMessages(prev => [...prev, userMessage]);\n    const currentMessage = inputMessage;\n    setInputMessage('');\n    setIsLoading(true);\n\n    try {\n      // Call the QA API\n      const response = await fetch('/api/qa', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          question: currentMessage,\n          bookId: id,\n          context: bookContent\n        }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        const assistantMessage: ChatMessage = {\n          id: (Date.now() + 1).toString(),\n          type: 'assistant',\n          content: data.data.answer,\n          timestamp: new Date(),\n          references: data.data.references.map((ref: any) => ref.id),\n        };\n\n        // Store references\n        const refsMap: Record<string, Reference[]> = {};\n        data.data.references.forEach((ref: any) => {\n          refsMap[ref.id] = [{\n            id: ref.id,\n            content: ref.content,\n            page: ref.page,\n            chapter: ref.chapter\n          }];\n        });\n        setReferences(prev => ({ ...prev, ...refsMap }));\n\n        setChatMessages(prev => [...prev, assistantMessage]);\n      } else {\n        throw new Error(data.error || 'Failed to get response');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n      const errorMessage: ChatMessage = {\n        id: (Date.now() + 1).toString(),\n        type: 'assistant',\n        content: 'Sorry, I encountered an error processing your question. Please try again.',\n        timestamp: new Date(),\n      };\n      setChatMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const toggleReferences = (messageId: string) => {\n    setShowReferences(showReferences === messageId ? null : messageId);\n  };\n\n\n  // Page selection functions\n  const handlePageSelect = () => {\n    const pageNum = parseInt(pageInput);\n    if (pageNum >= 1 && pageNum <= totalPages) {\n      setCurrentPage(pageNum);\n      setShowPageSelector(false);\n      setPageInput('');\n    }\n  };\n\n  const handlePageInputKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handlePageSelect();\n    } else if (e.key === 'Escape') {\n      setShowPageSelector(false);\n      setPageInput('');\n    }\n  };\n\n  // Get current page chunks (each chunk is now one page)\n  const currentPageChunks = useMemo(() => {\n    const chunkIndex = currentPage - 1; // Convert page number to 0-based index\n    console.log('currentPageChunks calculation:', {\n      currentPage,\n      chunkIndex,\n      contentChunksLength: contentChunks.length,\n      hasChunk: chunkIndex >= 0 && chunkIndex < contentChunks.length\n    });\n    \n    if (chunkIndex >= 0 && chunkIndex < contentChunks.length) {\n      const chunk = contentChunks[chunkIndex];\n      console.log('Selected chunk:', { chunkId: chunk?.id, chunkPage: chunk?.page, chunkContentLength: chunk?.content?.length });\n      return [chunk]; // Return single chunk as array\n    }\n    return [];\n  }, [contentChunks, currentPage]);\n\n  // Save current page to database\n  const saveCurrentPage = useCallback(async (page: number) => {\n    console.log('Saving current page:', { id, page, totalPages });\n    if (id && page > 0 && totalPages > 0) {\n      try {\n        const response = await fetch(`/api/books/${id}/current-page`, {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ currentPage: page }),\n        });\n        const result = await response.json();\n        console.log('Save response:', result);\n      } catch (error) {\n        console.error('Error saving current page:', error);\n      }\n    }\n  }, [id, totalPages]);\n\n  // Navigation functions\n  const goToNextPage = useCallback(() => {\n    if (currentPage < totalPages) {\n      setCurrentPage(prev => prev + 1);\n    }\n  }, [currentPage, totalPages]);\n\n  const goToPreviousPage = useCallback(() => {\n    if (currentPage > 1) {\n      setCurrentPage(prev => prev - 1);\n    }\n  }, [currentPage]);\n\n  // Memoized markdown component\n  const MemoizedMarkdown = memo(({ content, isTOC = false }: { content: string; isTOC?: boolean }) => {\n    // For TOC pages (first 5), render as plain text without markdown formatting\n    if (isTOC) {\n      return (\n        <div className=\"text-base leading-relaxed whitespace-pre-line\">\n          {content}\n        </div>\n      );\n    }\n\n    // For regular pages, use full markdown formatting\n    return (\n      <ReactMarkdown \n        remarkPlugins={[remarkGfm]}\n        components={{\n          h1: ({children}) => <h1 className=\"text-3xl font-bold text-gray-900 mt-0 mb-4\">{children}</h1>,\n          h2: ({children}) => <h2 className=\"text-2xl font-semibold text-gray-800 mt-0 mb-3\">{children}</h2>,\n          h3: ({children}) => <h3 className=\"text-xl font-semibold text-gray-700 mt-0 mb-2\">{children}</h3>,\n          p: ({children}) => <p className=\"mb-4 leading-relaxed text-base\">{children}</p>,\n          ul: ({children}) => <ul className=\"list-disc list-inside mb-4 space-y-1 ml-2\">{children}</ul>,\n          ol: ({children}) => <ol className=\"list-decimal list-inside mb-4 space-y-1 ml-2\">{children}</ol>,\n          li: ({children}) => <li className=\"text-base leading-relaxed\">{children}</li>,\n          strong: ({children}) => <strong className=\"font-semibold text-gray-900\">{children}</strong>,\n          em: ({children}) => <em className=\"italic text-gray-700\">{children}</em>,\n          blockquote: ({children}) => <blockquote className=\"border-l-4 border-amber-300 pl-4 italic text-gray-600 my-4 text-base\">{children}</blockquote>,\n          code: ({children}) => <code className=\"bg-gray-100 px-2 py-1 rounded text-sm font-mono\">{children}</code>,\n          pre: ({children}) => <pre className=\"bg-gray-100 p-3 rounded-lg overflow-x-auto my-4 text-sm\">{children}</pre>,\n        }}\n      >\n        {content}\n      </ReactMarkdown>\n    );\n  });\n\n  MemoizedMarkdown.displayName = 'MemoizedMarkdown';\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Only handle shortcuts when not typing in input fields\n      if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) {\n        return;\n      }\n\n      switch (e.key) {\n        case 'ArrowLeft':\n          e.preventDefault();\n          goToPreviousPage();\n          break;\n        case 'ArrowRight':\n          e.preventDefault();\n          goToNextPage();\n          break;\n        case 'c':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            setIsChatOpen(!isChatOpen);\n          }\n          break;\n        case 'Escape':\n          if (showPageSelector) {\n            setShowPageSelector(false);\n            setPageInput('');\n          } else {\n            setIsChatOpen(false);\n          }\n          break;\n        case 'g':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            setShowPageSelector(true);\n          }\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [goToPreviousPage, goToNextPage, isChatOpen, showPageSelector]);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center space-x-4\">\n              <Link href=\"/\">\n                <motion.button\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                  className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                >\n                  <ArrowLeft className=\"h-5 w-5 text-gray-600\" />\n                </motion.button>\n              </Link>\n              <div className=\"flex items-center space-x-3\">\n                <BookOpen className=\"h-6 w-6 text-amber-600\" />\n                <h1 className=\"text-lg font-semibold text-gray-900\">{bookMetadata?.title || 'Loading...'}</h1>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <button \n                className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                title=\"Settings (Coming Soon)\"\n              >\n                <Settings className=\"h-5 w-5 text-gray-600\" />\n              </button>\n              <motion.button\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n                onClick={() => setIsChatOpen(!isChatOpen)}\n                className=\"p-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg transition-colors\"\n                title=\"Toggle Chat (Ctrl+C)\"\n              >\n                <MessageCircle className=\"h-5 w-5\" />\n              </motion.button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"flex\">\n        {/* Main Reading Area */}\n        <main className={`flex-1 transition-all duration-300 ${isChatOpen ? 'mr-80' : ''} h-screen overflow-y-auto`}>\n          <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 min-h-full\">\n\n            {/* Loading State */}\n            {isProcessing && (\n              <div className=\"bg-white rounded-xl shadow-lg p-8 h-[calc(100vh-12rem)] flex flex-col overflow-hidden\">\n                <div className=\"text-center mb-4\">\n                  <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto mb-4\"></div>\n                  <p className=\"text-gray-600\">Processing book content...</p>\n                </div>\n                \n                {/* Loading skeleton */}\n                <div className=\"space-y-3 flex-1 flex flex-col justify-center\">\n                  <div className=\"h-6 bg-gray-200 rounded animate-pulse\"></div>\n                  <div className=\"space-y-2\">\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse w-3/4\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse w-1/2\"></div>\n                  </div>\n                  <div className=\"h-5 bg-gray-200 rounded animate-pulse w-1/3\"></div>\n                  <div className=\"space-y-2\">\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse w-5/6\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse w-2/3\"></div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse w-4/5\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded animate-pulse w-3/5\"></div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Book Content */}\n            {!isProcessing && (\n              <div className=\"bg-white rounded-xl shadow-lg p-8 h-[calc(100vh-12rem)] flex flex-col relative overflow-hidden\">\n                <div className=\"text-gray-800 leading-relaxed flex-1 flex flex-col\">\n                  {currentPageChunks.map((chunk, index) => (\n                    <div key={chunk.id} className=\"h-full flex flex-col\">\n                      {chunk.chapter && index === 0 && chunk.chapter.length > 10 && \n                       !chunk.chapter.toLowerCase().includes('steve jobs') && \n                       !chunk.chapter.toLowerCase().includes('biography') && (\n                        <div className=\"mb-4 p-4 bg-amber-50 border-l-4 border-amber-300 rounded-r-lg flex-shrink-0\">\n                          <h2 className=\"text-xl font-semibold text-amber-800\">{chunk.chapter}</h2>\n                        </div>\n                      )}\n                      <div className=\"prose prose-lg max-w-none flex-1\">\n                        <MemoizedMarkdown content={chunk.content} isTOC={currentPage <= 5} />\n                      </div>\n                    </div>\n                  ))}\n                  \n                  {currentPageChunks.length === 0 && (\n                    <div className=\"text-center text-gray-500 flex items-center justify-center h-full\">\n                      <div>\n                        <BookOpen className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                        <p>No content available for this section.</p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Navigation */}\n            <div className=\"flex justify-between items-center mt-8\">\n              <div className=\"flex items-center space-x-2\">\n                <button\n                  onClick={goToPreviousPage}\n                  disabled={currentPage === 1}\n                  className=\"flex items-center space-x-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Previous page (←)\"\n                >\n                  <ChevronUp className=\"h-4 w-4\" />\n                  <span>Previous</span>\n                </button>\n              </div>\n              \n              <div className=\"flex items-center space-x-1\">\n                {/* Calculate sliding window of page numbers */}\n                {(() => {\n                  const maxVisible = 5;\n                  let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));\n                  let endPage = Math.min(totalPages, startPage + maxVisible - 1);\n                  \n                  // Adjust start if we're near the end\n                  if (endPage - startPage < maxVisible - 1) {\n                    startPage = Math.max(1, endPage - maxVisible + 1);\n                  }\n                  \n                  const pages = [];\n                  \n                  // Add first page and ellipsis if needed\n                  if (startPage > 1) {\n                    pages.push(\n                      <button\n                        key={1}\n                        onClick={() => setCurrentPage(1)}\n                        className=\"w-8 h-8 rounded text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors\"\n                      >\n                        1\n                      </button>\n                    );\n                    if (startPage > 2) {\n                      pages.push(\n                        <button\n                          key=\"ellipsis-start\"\n                          onClick={() => setShowPageSelector(true)}\n                          className=\"w-8 h-8 rounded text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors\"\n                          title=\"Select section (Ctrl+G)\"\n                        >\n                          ...\n                        </button>\n                      );\n                    }\n                  }\n                  \n                  // Add visible page range\n                  for (let i = startPage; i <= endPage; i++) {\n                    const isActive = i === currentPage;\n                    pages.push(\n                      <button\n                        key={i}\n                        onClick={() => setCurrentPage(i)}\n                        className={`w-8 h-8 rounded text-sm font-medium transition-colors ${\n                          isActive \n                            ? 'bg-amber-600 text-white' \n                            : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                        }`}\n                      >\n                        {i}\n                      </button>\n                    );\n                  }\n                  \n                  // Add ellipsis and last page if needed\n                  if (endPage < totalPages) {\n                    if (endPage < totalPages - 1) {\n                      pages.push(\n                        <button\n                          key=\"ellipsis-end\"\n                          onClick={() => setShowPageSelector(true)}\n                          className=\"w-8 h-8 rounded text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors\"\n                          title=\"Select section (Ctrl+G)\"\n                        >\n                          ...\n                        </button>\n                      );\n                    }\n                    pages.push(\n                      <button\n                        key={totalPages}\n                        onClick={() => setCurrentPage(totalPages)}\n                        className=\"w-8 h-8 rounded text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors\"\n                      >\n                        {totalPages}\n                      </button>\n                    );\n                  }\n                  \n                  return pages;\n                })()}\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <button\n                  onClick={goToNextPage}\n                  disabled={currentPage === totalPages}\n                  className=\"flex items-center space-x-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Next page (→)\"\n                >\n                  <span>Next</span>\n                  <ChevronDown className=\"h-4 w-4\" />\n                </button>\n              </div>\n            </div>\n          </div>\n        </main>\n\n        {/* Chat Sidebar */}\n        <AnimatePresence>\n          {isChatOpen && (\n            <motion.aside\n              initial={{ x: 320 }}\n              animate={{ x: 0 }}\n              exit={{ x: 320 }}\n              className=\"fixed right-0 top-16 bottom-0 w-80 bg-white shadow-xl border-l border-gray-200 flex flex-col z-30\"\n            >\n              {/* Chat Header */}\n              <div className=\"p-4 border-b border-gray-200\">\n                <div className=\"flex items-center justify-between\">\n                  <h2 className=\"text-lg font-semibold text-gray-900\">AI Assistant</h2>\n                  <button\n                    onClick={() => setIsChatOpen(false)}\n                    className=\"p-1 hover:bg-gray-100 rounded transition-colors\"\n                  >\n                    <X className=\"h-4 w-4 text-gray-600\" />\n                  </button>\n                </div>\n              </div>\n\n              {/* Chat Messages */}\n              <div \n                ref={chatContainerRef}\n                className=\"flex-1 overflow-y-auto p-4 space-y-4\"\n              >\n                {chatMessages.length === 0 ? (\n                  <div className=\"text-center text-gray-500 py-8\">\n                    <Bot className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p>Ask me anything about this book!</p>\n                  </div>\n                ) : (\n                  chatMessages.map((message) => (\n                    <ChatMessageComponent\n                      key={message.id}\n                      message={message}\n                      showReferences={showReferences}\n                      references={references}\n                      onToggleReferences={toggleReferences}\n                    />\n                  ))\n                )}\n\n                {/* References */}\n                <AnimatePresence>\n                  {showReferences && references[showReferences] && (\n                    <motion.div\n                      initial={{ opacity: 0, height: 0 }}\n                      animate={{ opacity: 1, height: 'auto' }}\n                      exit={{ opacity: 0, height: 0 }}\n                      className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\"\n                    >\n                      <h4 className=\"font-semibold text-amber-900 mb-2\">References</h4>\n                      {references[showReferences].map((ref) => (\n                        <div key={ref.id} className=\"mb-2 last:mb-0\">\n                          <div className=\"text-sm text-amber-800\">\n                            <strong>{ref.chapter}</strong>\n                            {ref.page && <span className=\"ml-2 text-amber-600\">(Page {ref.page})</span>}\n                          </div>\n                          <div className=\"text-xs text-amber-700 mt-1 italic\">\n                            \"{ref.content}\"\n                          </div>\n                        </div>\n                      ))}\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n\n                {/* Loading Indicator */}\n                {isLoading && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    className=\"flex justify-start\"\n                  >\n                    <div className=\"bg-gray-100 rounded-lg px-4 py-2\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Bot className=\"h-4 w-4\" />\n                        <div className=\"flex space-x-1\">\n                          <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\n                          <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></div>\n                          <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n              </div>\n\n              {/* Chat Input */}\n              <div className=\"p-4 border-t border-gray-200\">\n                <div className=\"flex space-x-2\">\n                  <input\n                    ref={chatInputRef}\n                    type=\"text\"\n                    value={inputMessage}\n                    onChange={(e) => setInputMessage(e.target.value)}\n                    onKeyPress={handleKeyPress}\n                    placeholder=\"Ask about the book...\"\n                    className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent\"\n                    disabled={isLoading}\n                  />\n                  <motion.button\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    onClick={handleSendMessage}\n                    disabled={!inputMessage.trim() || isLoading}\n                    className=\"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    <Send className=\"h-4 w-4\" />\n                  </motion.button>\n                </div>\n              </div>\n            </motion.aside>\n          )}\n        </AnimatePresence>\n      </div>\n\n      {/* Page Selector Modal */}\n      <AnimatePresence>\n        {showPageSelector && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\"\n            onClick={() => setShowPageSelector(false)}\n          >\n            <motion.div\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n              className=\"bg-white rounded-xl p-6 w-80 max-w-sm mx-4\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-lg font-semibold text-gray-900\">Go to Section</h3>\n                <button\n                  onClick={() => setShowPageSelector(false)}\n                  className=\"p-1 hover:bg-gray-100 rounded transition-colors\"\n                >\n                  <X className=\"h-5 w-5 text-gray-600\" />\n                </button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Enter section number (1-{totalPages})\n                  </label>\n                  <input\n                    type=\"number\"\n                    min=\"1\"\n                    max={totalPages}\n                    value={pageInput}\n                    onChange={(e) => setPageInput(e.target.value)}\n                    onKeyPress={handlePageInputKeyPress}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent\"\n                    placeholder={`1-${totalPages}`}\n                    autoFocus\n                  />\n                </div>\n                \n                <div className=\"flex justify-end space-x-2\">\n                  <button\n                    onClick={() => setShowPageSelector(false)}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handlePageSelect}\n                    disabled={!pageInput || parseInt(pageInput) < 1 || parseInt(pageInput) > totalPages}\n                    className=\"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    Go\n                  </button>\n                </div>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;AACA;;;AAnBA;;;;;;;AA2CA,MAAM,aAAa,MAAM,gEAAgE;AACzF,MAAM,kBAAkB,GAAG,8CAA8C;AAEzE,kCAAkC;AAClC,MAAM,qCAAuB,IAAA,qKAAI,EAAC;QAAC,EACjC,OAAO,EACP,cAAc,EACd,UAAU,EACV,kBAAkB,EAMnB;yBACC,6LAAC,uMAAM,CAAC,GAAG;QACT,SAAS;YAAE,SAAS;YAAG,GAAG;QAAG;QAC7B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,WAAW,AAAC,QAAiE,OAA1D,QAAQ,IAAI,KAAK,SAAS,gBAAgB;kBAE7D,cAAA,6LAAC;YAAI,WAAW,AAAC,iCAIhB,OAHC,QAAQ,IAAI,KAAK,SACb,4BACA;sBAEJ,cAAA,6LAAC;gBAAI,WAAU;;oBACZ,QAAQ,IAAI,KAAK,6BAChB,6LAAC,0MAAG;wBAAC,WAAU;;;;;;oBAEhB,QAAQ,IAAI,KAAK,wBAChB,6LAAC,6MAAI;wBAAC,WAAU;;;;;;kCAElB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAE,WAAU;0CAAW,QAAQ,OAAO;;;;;;4BACtC,QAAQ,UAAU,IAAI,QAAQ,UAAU,CAAC,MAAM,GAAG,mBACjD,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,SAAS,IAAM,mBAAmB,QAAQ,EAAE;wCAC5C,WAAU;;4CAET,mBAAmB,QAAQ,EAAE,GAAG,SAAS;4CAAO;4CAAc,QAAQ,UAAU,CAAC,MAAM;4CAAC;;;;;;;kDAE3F,6LAAC,0KAAI;wCAAC,MAAM,AAAC,OAAiB,OAAX,QAAQ,EAAE;kDAC3B,cAAA,6LAAC;4CAAO,WAAU;sDAA0D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAvCtF;AAmDN,qBAAqB,WAAW,GAAG;AAEpB,SAAS,WAAW,KAA+C;QAA/C,EAAE,MAAM,EAAuC,GAA/C;;IACjC,MAAM,EAAE,EAAE,EAAE,GAAG,IAAA,oKAAG,EAAC;IACnB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAgB,EAAE;IAClE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAgB;IACpE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAA8B,CAAC;IAC3E,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAS;IACvD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAiB,EAAE;IACrE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAM;IACtD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IAEnD,MAAM,eAAe,IAAA,uKAAM,EAAmB;IAC9C,MAAM,mBAAmB,IAAA,uKAAM,EAAiB;IAEhD,4DAA4D;IAC5D,IAAA,0KAAS;gCAAC;YACR,MAAM;wDAAkB;oBACtB,IAAI,MAAM,cAAc,KAAK,aAAa,KAAK,CAAC,eAAe;wBAC7D,QAAQ,GAAG,CAAC,wBAAwB;4BAAE;4BAAI;wBAAY;wBACtD,yDAAyD;wBACzD,MAAM,OAAO,KAAK,SAAS,CAAC;4BAAE;wBAAY;wBAC1C,IAAI,UAAU,UAAU,EAAE;4BACxB,UAAU,UAAU,CAAC,AAAC,cAAgB,OAAH,IAAG,kBAAgB;wBACxD,OAAO;4BACL,MAAM,AAAC,cAAgB,OAAH,IAAG,kBAAgB;gCACrC,QAAQ;gCACR,SAAS;oCACP,gBAAgB;gCAClB;gCACA,MAAM;4BACR,GAAG,KAAK;wEAAC,CAAA;oCACP,QAAQ,KAAK,CAAC,sCAAsC;gCACtD;;wBACF;oBACF;gBACF;;YAEA,sBAAsB;YACtB,MAAM;2DAAqB;oBACzB;gBACF;;YAEA,OAAO,gBAAgB,CAAC,gBAAgB;YAExC;wCAAO;oBACL,OAAO,mBAAmB,CAAC,gBAAgB;oBAC3C,iCAAiC;oBACjC;gBACF;;QACF;+BAAG;QAAC;QAAI;QAAa;QAAY;KAAc;IAE/C,4BAA4B;IAC5B,IAAA,0KAAS;gCAAC;YACR,QAAQ,GAAG,CAAC,2BAA2B;QACzC;+BAAG;QAAC;KAAY;IAEhB,sDAAsD;IACtD,IAAA,0KAAS;gCAAC;YACR,IAAI,iBAAiB,OAAO,EAAE;gBAC5B,iBAAiB,OAAO,CAAC,SAAS,GAAG,iBAAiB,OAAO,CAAC,YAAY;YAC5E;QACF;+BAAG;QAAC;KAAa;IAEjB,qCAAqC;IACrC,MAAM,sBAAsB,IAAA,4KAAW;uDAAC,CAAC;YACvC,MAAM,QAAQ,QAAQ,KAAK,CAAC;YAC5B,KAAK,MAAM,QAAQ,MAAO;gBACxB,8DAA8D;gBAC9D,IAAI,KAAK,UAAU,CAAC,OAAO;oBACzB,MAAM,QAAQ,KAAK,OAAO,CAAC,MAAM,IAAI,IAAI;oBACzC,uDAAuD;oBACvD,MAAM,aAAa,MAAM,WAAW;oBACpC,IAAI,MAAM,MAAM,GAAG,MACf,CAAC,WAAW,QAAQ,CAAC,iBACrB,CAAC,WAAW,QAAQ,CAAC,gBACrB,CAAC,WAAW,QAAQ,CAAC,yBACrB,CAAC,WAAW,QAAQ,CAAC,wBACrB,CAAC,WAAW,QAAQ,CAAC,mBACrB,CAAC,WAAW,QAAQ,CAAC,cACrB,CAAC,WAAW,QAAQ,CAAC,sBACrB,CAAC,WAAW,QAAQ,CAAC,YACrB,CAAC,WAAW,QAAQ,CAAC,UAAU;wBACjC,OAAO;oBACT;gBACF;YACF;YACA,OAAO;QACT;sDAAG,EAAE;IAEL,oCAAoC;IACpC,MAAM,eAAe,IAAA,4KAAW;gDAAC,CAAC;YAChC,MAAM,SAAyB,EAAE;YACjC,MAAM,QAAQ,QAAQ,KAAK,CAAC;YAC5B,IAAI,eAAe;YACnB,IAAI,aAAa;YACjB,IAAI,aAAa;YACjB,IAAI,iBAAiB;YACrB,IAAI,UAAU;YAEd,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;gBACrC,MAAM,OAAO,KAAK,CAAC,EAAE;gBACrB,MAAM,iBAAiB,eAAe,CAAC,eAAe,OAAO,EAAE,IAAI;gBAEnE,yEAAyE;gBACzE,IAAI,cAAc,KAAK,CACnB,KAAK,WAAW,GAAG,QAAQ,CAAC,wBAC5B,KAAK,WAAW,GAAG,QAAQ,CAAC,eAC3B,KAAK,WAAW,GAAG,QAAQ,CAAC,cAAc,KAAK,MAAM,GAAG,OACxD,KAAK,WAAW,GAAG,QAAQ,CAAC,WAAW,KAAK,MAAM,GAAG,OACrD,KAAK,UAAU,CAAC,QAAQ,CAAC,KAAK,WAAW,GAAG,QAAQ,CAAC,cAAc,KAAK,WAAW,GAAG,QAAQ,CAAC,OAAO,KACtG,KAAK,KAAK,CAAC,aAAa,KAAK,MAAM,GAAG,GAAI,GAAG;oBAChD,UAAU;gBACZ;gBAEA,uEAAuE;gBACvE,IAAI,aAAa,KAAM,KAAK,UAAU,CAAC,QAAQ,KAAK,MAAM,GAAG,MAAM,CAAC,KAAK,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,KAAK,WAAW,GAAG,QAAQ,CAAC,SAAU;oBACnJ,UAAU;gBACZ;gBAEA,0CAA0C;gBAC1C,IAAI,KAAK,UAAU,CAAC,OAAO;oBACzB,MAAM,QAAQ,KAAK,OAAO,CAAC,MAAM,IAAI,IAAI;oBACzC,qEAAqE;oBACrE,MAAM,aAAa,MAAM,WAAW;oBACpC,IAAI,MAAM,MAAM,GAAG,MACf,CAAC,WAAW,QAAQ,CAAC,iBACrB,CAAC,WAAW,QAAQ,CAAC,gBACrB,CAAC,WAAW,QAAQ,CAAC,yBACrB,CAAC,WAAW,QAAQ,CAAC,wBACrB,CAAC,WAAW,QAAQ,CAAC,mBACrB,CAAC,WAAW,QAAQ,CAAC,cACrB,CAAC,WAAW,QAAQ,CAAC,sBACrB,CAAC,WAAW,QAAQ,CAAC,YACrB,CAAC,WAAW,QAAQ,CAAC,UAAU;wBACjC,iBAAiB;oBACnB;gBACF;gBAEA,kEAAkE;gBAClE,IAAI;gBACJ,IAAI,WAAW,cAAc,GAAG;oBAC9B,mBAAmB,aAAa,KAAK,gCAAgC;gBACvE,OAAO;oBACL,mBAAmB,YAAY,wCAAwC;gBACzE;gBAEA,oDAAoD;gBACpD,IAAI,eAAe,MAAM,GAAG,oBAAoB,cAAc;oBAC5D,wEAAwE;oBACxE,IAAI,SAAS;wBACX,MAAM,cAAc,aAAa,WAAW,CAAC;wBAC7C,IAAI,cAAc,mBAAmB,KAAK;4BACxC,MAAM,eAAe,aAAa,SAAS,CAAC,GAAG,aAAa,IAAI;4BAChE,MAAM,eAAe,oBAAoB;4BACzC,OAAO,IAAI,CAAC;gCACV,IAAI,AAAC,SAAmB,OAAX;gCACb,SAAS;gCACT,MAAM;gCACN,SAAS,gBAAgB,CAAC,kBAAkB,mBAAmB,eAAe,iBAAiB,SAAS;4BAC1G;4BACA,eAAe,aAAa,SAAS,CAAC,cAAc,KAAK,CAAC,OAAO,OAAO,OAAO,EAAE;wBACnF,OAAO;4BACL,2BAA2B;4BAC3B,MAAM,eAAe,oBAAoB;4BACzC,OAAO,IAAI,CAAC;gCACV,IAAI,AAAC,SAAmB,OAAX;gCACb,SAAS;gCACT,MAAM;gCACN,SAAS,gBAAgB,CAAC,kBAAkB,mBAAmB,eAAe,iBAAiB,SAAS;4BAC1G;4BACA,eAAe;wBACjB;oBACF,OAAO;wBACL,mDAAmD;wBACnD,MAAM,qBAAqB,aAAa,WAAW,CAAC;wBACpD,IAAI,qBAAqB,mBAAmB,KAAK;4BAC/C,MAAM,eAAe,aAAa,SAAS,CAAC,GAAG,oBAAoB,IAAI;4BACvE,MAAM,eAAe,oBAAoB;4BACzC,OAAO,IAAI,CAAC;gCACV,IAAI,AAAC,SAAmB,OAAX;gCACb,SAAS;gCACT,MAAM;gCACN,SAAS,gBAAgB,CAAC,kBAAkB,mBAAmB,eAAe,iBAAiB,SAAS;4BAC1G;4BACA,eAAe,aAAa,SAAS,CAAC,qBAAqB,KAAK,CAAC,OAAO,OAAO,OAAO,EAAE;wBAC1F,OAAO;4BACL,2BAA2B;4BAC3B,MAAM,eAAe,oBAAoB;4BACzC,OAAO,IAAI,CAAC;gCACV,IAAI,AAAC,SAAmB,OAAX;gCACb,SAAS;gCACT,MAAM;gCACN,SAAS,gBAAgB,CAAC,kBAAkB,mBAAmB,eAAe,iBAAiB,SAAS;4BAC1G;4BACA,eAAe;wBACjB;oBACF;oBAEA;oBACA,cAAc,gCAAgC;gBAChD,OAAO;oBACL,eAAe;gBACjB;YACF;YAEA,kCAAkC;YAClC,IAAI,aAAa,IAAI,IAAI;gBACvB,MAAM,eAAe,oBAAoB;gBACzC,OAAO,IAAI,CAAC;oBACV,IAAI,AAAC,SAAmB,OAAX;oBACb,SAAS;oBACT,MAAM;oBACN,SAAS,gBAAgB,CAAC,kBAAkB,mBAAmB,eAAe,iBAAiB,SAAS;gBAC1G;YACF;YAEA,OAAO;QACT;+CAAG;QAAC;KAAoB;IAExB,6BAA6B;IAC7B,IAAA,0KAAS;gCAAC;YACR,MAAM;iDAAW;oBACf,gBAAgB;oBAChB,IAAI;wBACF,8DAA8D;wBAC9D,MAAM,WAAW,MAAM,MAAM,AAAC,cAAgB,OAAH;wBAC3C,IAAI,SAAS,EAAE,EAAE;4BACf,MAAM,OAAO,MAAM,SAAS,IAAI;4BAChC,IAAI,KAAK,OAAO,EAAE;gCAChB,MAAM,OAAO,KAAK,IAAI;gCACtB,gBAAgB;gCAChB,eAAe,KAAK,OAAO,IAAI;gCAE/B,2CAA2C;gCAC3C,MAAM,SAAS,aAAa,KAAK,OAAO,IAAI;gCAC5C,iBAAiB;gCACjB,cAAc,OAAO,MAAM;gCAE3B,0CAA0C;gCAC1C,QAAQ,GAAG,CAAC,gBAAgB;oCAC1B,QAAQ,KAAK,EAAE;oCACf,aAAa,KAAK,WAAW;oCAC7B,cAAc,OAAO,MAAM;oCAC3B,OAAO,KAAK,KAAK;oCACjB,iBAAiB,OAAO,KAAK,WAAW;gCAC1C;gCAEA,IAAI,KAAK,WAAW,IAAI,KAAK,WAAW,IAAI,KAAK,KAAK,WAAW,IAAI,OAAO,MAAM,EAAE;oCAClF,QAAQ,GAAG,CAAC,sCAAsC,KAAK,WAAW;oCAClE,eAAe,KAAK,WAAW;gCACjC,OAAO;oCACL,QAAQ,GAAG,CAAC,sDAAsD,KAAK,WAAW,EAAE,iBAAiB,OAAO,MAAM;oCAClH,eAAe,IAAI,4CAA4C;gCACjE;gCAEA,gCAAgC;gCAChC,iBAAiB;4BACnB;wBACF,OAAO;4BACL,oEAAoE;4BACpE,MAAM,WAAW,MAAM,MAAM;4BAC7B,MAAM,OAAO,MAAM,SAAS,IAAI;4BAChC,IAAI,KAAK,OAAO,EAAE;gCAChB,MAAM,OAAO,KAAK,IAAI,CAAC,IAAI;0EAAC,CAAC,IAAW,EAAE,EAAE,KAAK;;gCACjD,IAAI,MAAM;oCACR,gBAAgB;oCAChB,eAAe,KAAK,OAAO,IAAI;oCAE/B,2CAA2C;oCAC3C,MAAM,SAAS,aAAa,KAAK,OAAO,IAAI;oCAC5C,iBAAiB;oCACjB,cAAc,OAAO,MAAM;oCAE3B,0CAA0C;oCAC1C,IAAI,KAAK,WAAW,IAAI,KAAK,WAAW,IAAI,KAAK,KAAK,WAAW,IAAI,OAAO,MAAM,EAAE;wCAClF,eAAe,KAAK,WAAW;oCACjC,OAAO;wCACL,eAAe,IAAI,4CAA4C;oCACjE;oCAEA,gCAAgC;oCAChC,iBAAiB;gCACnB;4BACF;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,uBAAuB;wBACrC,2BAA2B;wBAC3B,MAAM,cAAc,AAAC,2lHAsDnB,IAAI;wBACN,eAAe;wBACf,MAAM,SAAS,aAAa;wBAC5B,iBAAiB;wBACjB,cAAc,KAAK,IAAI,CAAC,OAAO,MAAM,GAAG;oBAC1C,SAAU;wBACR,gBAAgB;oBAClB;gBACF;;YAEA;QACF;+BAAG;QAAC;QAAI;KAAa;IAErB,MAAM,oBAAoB;QACxB,IAAI,CAAC,aAAa,IAAI,MAAM,WAAW;QAEvC,MAAM,cAA2B;YAC/B,IAAI,KAAK,GAAG,GAAG,QAAQ;YACvB,MAAM;YACN,SAAS;YACT,WAAW,IAAI;QACjB;QAEA,gBAAgB,CAAA,OAAQ;mBAAI;gBAAM;aAAY;QAC9C,MAAM,iBAAiB;QACvB,gBAAgB;QAChB,aAAa;QAEb,IAAI;YACF,kBAAkB;YAClB,MAAM,WAAW,MAAM,MAAM,WAAW;gBACtC,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,UAAU;oBACV,QAAQ;oBACR,SAAS;gBACX;YACF;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,KAAK,OAAO,EAAE;gBAChB,MAAM,mBAAgC;oBACpC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,EAAE,QAAQ;oBAC7B,MAAM;oBACN,SAAS,KAAK,IAAI,CAAC,MAAM;oBACzB,WAAW,IAAI;oBACf,YAAY,KAAK,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,MAAa,IAAI,EAAE;gBAC3D;gBAEA,mBAAmB;gBACnB,MAAM,UAAuC,CAAC;gBAC9C,KAAK,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;oBAC5B,OAAO,CAAC,IAAI,EAAE,CAAC,GAAG;wBAAC;4BACjB,IAAI,IAAI,EAAE;4BACV,SAAS,IAAI,OAAO;4BACpB,MAAM,IAAI,IAAI;4BACd,SAAS,IAAI,OAAO;wBACtB;qBAAE;gBACJ;gBACA,cAAc,CAAA,OAAQ,CAAC;wBAAE,GAAG,IAAI;wBAAE,GAAG,OAAO;oBAAC,CAAC;gBAE9C,gBAAgB,CAAA,OAAQ;2BAAI;wBAAM;qBAAiB;YACrD,OAAO;gBACL,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,MAAM,eAA4B;gBAChC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,EAAE,QAAQ;gBAC7B,MAAM;gBACN,SAAS;gBACT,WAAW,IAAI;YACjB;YACA,gBAAgB,CAAA,OAAQ;uBAAI;oBAAM;iBAAa;QACjD,SAAU;YACR,aAAa;QACf;IACF;IAEA,MAAM,iBAAiB,CAAC;QACtB,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;YACpC,EAAE,cAAc;YAChB;QACF;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,kBAAkB,mBAAmB,YAAY,OAAO;IAC1D;IAGA,2BAA2B;IAC3B,MAAM,mBAAmB;QACvB,MAAM,UAAU,SAAS;QACzB,IAAI,WAAW,KAAK,WAAW,YAAY;YACzC,eAAe;YACf,oBAAoB;YACpB,aAAa;QACf;IACF;IAEA,MAAM,0BAA0B,CAAC;QAC/B,IAAI,EAAE,GAAG,KAAK,SAAS;YACrB;QACF,OAAO,IAAI,EAAE,GAAG,KAAK,UAAU;YAC7B,oBAAoB;YACpB,aAAa;QACf;IACF;IAEA,uDAAuD;IACvD,MAAM,oBAAoB,IAAA,wKAAO;iDAAC;YAChC,MAAM,aAAa,cAAc,GAAG,uCAAuC;YAC3E,QAAQ,GAAG,CAAC,kCAAkC;gBAC5C;gBACA;gBACA,qBAAqB,cAAc,MAAM;gBACzC,UAAU,cAAc,KAAK,aAAa,cAAc,MAAM;YAChE;YAEA,IAAI,cAAc,KAAK,aAAa,cAAc,MAAM,EAAE;oBAEyC;gBADjG,MAAM,QAAQ,aAAa,CAAC,WAAW;gBACvC,QAAQ,GAAG,CAAC,mBAAmB;oBAAE,OAAO,EAAE,kBAAA,4BAAA,MAAO,EAAE;oBAAE,SAAS,EAAE,kBAAA,4BAAA,MAAO,IAAI;oBAAE,kBAAkB,EAAE,kBAAA,6BAAA,iBAAA,MAAO,OAAO,cAAd,qCAAA,eAAgB,MAAM;gBAAC;gBACxH,OAAO;oBAAC;iBAAM,EAAE,+BAA+B;YACjD;YACA,OAAO,EAAE;QACX;gDAAG;QAAC;QAAe;KAAY;IAE/B,gCAAgC;IAChC,MAAM,kBAAkB,IAAA,4KAAW;mDAAC,OAAO;YACzC,QAAQ,GAAG,CAAC,wBAAwB;gBAAE;gBAAI;gBAAM;YAAW;YAC3D,IAAI,MAAM,OAAO,KAAK,aAAa,GAAG;gBACpC,IAAI;oBACF,MAAM,WAAW,MAAM,MAAM,AAAC,cAAgB,OAAH,IAAG,kBAAgB;wBAC5D,QAAQ;wBACR,SAAS;4BACP,gBAAgB;wBAClB;wBACA,MAAM,KAAK,SAAS,CAAC;4BAAE,aAAa;wBAAK;oBAC3C;oBACA,MAAM,SAAS,MAAM,SAAS,IAAI;oBAClC,QAAQ,GAAG,CAAC,kBAAkB;gBAChC,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,8BAA8B;gBAC9C;YACF;QACF;kDAAG;QAAC;QAAI;KAAW;IAEnB,uBAAuB;IACvB,MAAM,eAAe,IAAA,4KAAW;gDAAC;YAC/B,IAAI,cAAc,YAAY;gBAC5B;4DAAe,CAAA,OAAQ,OAAO;;YAChC;QACF;+CAAG;QAAC;QAAa;KAAW;IAE5B,MAAM,mBAAmB,IAAA,4KAAW;oDAAC;YACnC,IAAI,cAAc,GAAG;gBACnB;gEAAe,CAAA,OAAQ,OAAO;;YAChC;QACF;mDAAG;QAAC;KAAY;IAEhB,8BAA8B;IAC9B,MAAM,iCAAmB,IAAA,qKAAI,EAAC;YAAC,EAAE,OAAO,EAAE,QAAQ,KAAK,EAAwC;QAC7F,4EAA4E;QAC5E,IAAI,OAAO;YACT,qBACE,6LAAC;gBAAI,WAAU;0BACZ;;;;;;QAGP;QAEA,kDAAkD;QAClD,qBACE,6LAAC,sMAAa;YACZ,eAAe;gBAAC,2JAAS;aAAC;YAC1B,YAAY;gBACV,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAA8C;;;;;;;gBAChF,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAAkD;;;;;;;gBACpF,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAAiD;;;;;;;gBACnF,GAAG;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAE,WAAU;kCAAkC;;;;;;;gBAClE,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAA6C;;;;;;;gBAC/E,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAAgD;;;;;;;gBAClF,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAA6B;;;;;;;gBAC/D,QAAQ;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAO,WAAU;kCAA+B;;;;;;;gBACzE,IAAI;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAG,WAAU;kCAAwB;;;;;;;gBAC1D,YAAY;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAW,WAAU;kCAAwE;;;;;;;gBAC1H,MAAM;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAK,WAAU;kCAAmD;;;;;;;gBACzF,KAAK;wBAAC,EAAC,QAAQ,EAAC;yCAAK,6LAAC;wBAAI,WAAU;kCAA2D;;;;;;;YACjG;sBAEC;;;;;;IAGP;IAEA,iBAAiB,WAAW,GAAG;IAE/B,qBAAqB;IACrB,IAAA,0KAAS;gCAAC;YACR,MAAM;sDAAgB,CAAC;oBACrB,wDAAwD;oBACxD,IAAI,EAAE,MAAM,YAAY,oBAAoB,EAAE,MAAM,YAAY,qBAAqB;wBACnF;oBACF;oBAEA,OAAQ,EAAE,GAAG;wBACX,KAAK;4BACH,EAAE,cAAc;4BAChB;4BACA;wBACF,KAAK;4BACH,EAAE,cAAc;4BAChB;4BACA;wBACF,KAAK;4BACH,IAAI,EAAE,OAAO,IAAI,EAAE,OAAO,EAAE;gCAC1B,EAAE,cAAc;gCAChB,cAAc,CAAC;4BACjB;4BACA;wBACF,KAAK;4BACH,IAAI,kBAAkB;gCACpB,oBAAoB;gCACpB,aAAa;4BACf,OAAO;gCACL,cAAc;4BAChB;4BACA;wBACF,KAAK;4BACH,IAAI,EAAE,OAAO,IAAI,EAAE,OAAO,EAAE;gCAC1B,EAAE,cAAc;gCAChB,oBAAoB;4BACtB;4BACA;oBACJ;gBACF;;YAEA,OAAO,gBAAgB,CAAC,WAAW;YACnC;wCAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACrD;+BAAG;QAAC;QAAkB;QAAc;QAAY;KAAiB;IAEjE,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAO,WAAU;0BAChB,cAAA,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,0KAAI;wCAAC,MAAK;kDACT,cAAA,6LAAC,uMAAM,CAAC,MAAM;4CACZ,YAAY;gDAAE,OAAO;4CAAK;4CAC1B,UAAU;gDAAE,OAAO;4CAAK;4CACxB,WAAU;sDAEV,cAAA,6LAAC,gOAAS;gDAAC,WAAU;;;;;;;;;;;;;;;;kDAGzB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,6NAAQ;gDAAC,WAAU;;;;;;0DACpB,6LAAC;gDAAG,WAAU;0DAAuC,CAAA,yBAAA,mCAAA,aAAc,KAAK,KAAI;;;;;;;;;;;;;;;;;;0CAGhF,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,WAAU;wCACV,OAAM;kDAEN,cAAA,6LAAC,yNAAQ;4CAAC,WAAU;;;;;;;;;;;kDAEtB,6LAAC,uMAAM,CAAC,MAAM;wCACZ,YAAY;4CAAE,OAAO;wCAAK;wCAC1B,UAAU;4CAAE,OAAO;wCAAK;wCACxB,SAAS,IAAM,cAAc,CAAC;wCAC9B,WAAU;wCACV,OAAM;kDAEN,cAAA,6LAAC,4OAAa;4CAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAOnC,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAK,WAAW,AAAC,sCAA+D,OAA1B,aAAa,UAAU,IAAG;kCAC/E,cAAA,6LAAC;4BAAI,WAAU;;gCAGZ,8BACC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAE,WAAU;8DAAgB;;;;;;;;;;;;sDAI/B,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;;;;;;;;;;;8DAEjB,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;;;;;;;;;;;8DAEjB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;;;gCAOtB,CAAC,8BACA,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAI,WAAU;;4CACZ,kBAAkB,GAAG,CAAC,CAAC,OAAO,sBAC7B,6LAAC;oDAAmB,WAAU;;wDAC3B,MAAM,OAAO,IAAI,UAAU,KAAK,MAAM,OAAO,CAAC,MAAM,GAAG,MACvD,CAAC,MAAM,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,iBACtC,CAAC,MAAM,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,8BACrC,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAG,WAAU;0EAAwC,MAAM,OAAO;;;;;;;;;;;sEAGvE,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAiB,SAAS,MAAM,OAAO;gEAAE,OAAO,eAAe;;;;;;;;;;;;mDAT1D,MAAM,EAAE;;;;;4CAcnB,kBAAkB,MAAM,KAAK,mBAC5B,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;;sEACC,6LAAC,6NAAQ;4DAAC,WAAU;;;;;;sEACpB,6LAAC;sEAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CASf,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDACC,SAAS;gDACT,UAAU,gBAAgB;gDAC1B,WAAU;gDACV,OAAM;;kEAEN,6LAAC,gOAAS;wDAAC,WAAU;;;;;;kEACrB,6LAAC;kEAAK;;;;;;;;;;;;;;;;;sDAIV,6LAAC;4CAAI,WAAU;sDAEZ,CAAC;gDACA,MAAM,aAAa;gDACnB,IAAI,YAAY,KAAK,GAAG,CAAC,GAAG,cAAc,KAAK,KAAK,CAAC,aAAa;gDAClE,IAAI,UAAU,KAAK,GAAG,CAAC,YAAY,YAAY,aAAa;gDAE5D,qCAAqC;gDACrC,IAAI,UAAU,YAAY,aAAa,GAAG;oDACxC,YAAY,KAAK,GAAG,CAAC,GAAG,UAAU,aAAa;gDACjD;gDAEA,MAAM,QAAQ,EAAE;gDAEhB,wCAAwC;gDACxC,IAAI,YAAY,GAAG;oDACjB,MAAM,IAAI,eACR,6LAAC;wDAEC,SAAS,IAAM,eAAe;wDAC9B,WAAU;kEACX;uDAHM;;;;;oDAOT,IAAI,YAAY,GAAG;wDACjB,MAAM,IAAI,eACR,6LAAC;4DAEC,SAAS,IAAM,oBAAoB;4DACnC,WAAU;4DACV,OAAM;sEACP;2DAJK;;;;;oDAQV;gDACF;gDAEA,yBAAyB;gDACzB,IAAK,IAAI,IAAI,WAAW,KAAK,SAAS,IAAK;oDACzC,MAAM,WAAW,MAAM;oDACvB,MAAM,IAAI,eACR,6LAAC;wDAEC,SAAS,IAAM,eAAe;wDAC9B,WAAW,AAAC,yDAIX,OAHC,WACI,4BACA;kEAGL;uDARI;;;;;gDAWX;gDAEA,uCAAuC;gDACvC,IAAI,UAAU,YAAY;oDACxB,IAAI,UAAU,aAAa,GAAG;wDAC5B,MAAM,IAAI,eACR,6LAAC;4DAEC,SAAS,IAAM,oBAAoB;4DACnC,WAAU;4DACV,OAAM;sEACP;2DAJK;;;;;oDAQV;oDACA,MAAM,IAAI,eACR,6LAAC;wDAEC,SAAS,IAAM,eAAe;wDAC9B,WAAU;kEAET;uDAJI;;;;;gDAOX;gDAEA,OAAO;4CACT,CAAC;;;;;;sDAGH,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDACC,SAAS;gDACT,UAAU,gBAAgB;gDAC1B,WAAU;gDACV,OAAM;;kEAEN,6LAAC;kEAAK;;;;;;kEACN,6LAAC,sOAAW;wDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAQjC,6LAAC,+MAAe;kCACb,4BACC,6LAAC,uMAAM,CAAC,KAAK;4BACX,SAAS;gCAAE,GAAG;4BAAI;4BAClB,SAAS;gCAAE,GAAG;4BAAE;4BAChB,MAAM;gCAAE,GAAG;4BAAI;4BACf,WAAU;;8CAGV,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAG,WAAU;0DAAsC;;;;;;0DACpD,6LAAC;gDACC,SAAS,IAAM,cAAc;gDAC7B,WAAU;0DAEV,cAAA,6LAAC,oMAAC;oDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;8CAMnB,6LAAC;oCACC,KAAK;oCACL,WAAU;;wCAET,aAAa,MAAM,KAAK,kBACvB,6LAAC;4CAAI,WAAU;;8DACb,6LAAC,0MAAG;oDAAC,WAAU;;;;;;8DACf,6LAAC;8DAAE;;;;;;;;;;;mDAGL,aAAa,GAAG,CAAC,CAAC,wBAChB,6LAAC;gDAEC,SAAS;gDACT,gBAAgB;gDAChB,YAAY;gDACZ,oBAAoB;+CAJf,QAAQ,EAAE;;;;;sDAUrB,6LAAC,+MAAe;sDACb,kBAAkB,UAAU,CAAC,eAAe,kBAC3C,6LAAC,uMAAM,CAAC,GAAG;gDACT,SAAS;oDAAE,SAAS;oDAAG,QAAQ;gDAAE;gDACjC,SAAS;oDAAE,SAAS;oDAAG,QAAQ;gDAAO;gDACtC,MAAM;oDAAE,SAAS;oDAAG,QAAQ;gDAAE;gDAC9B,WAAU;;kEAEV,6LAAC;wDAAG,WAAU;kEAAoC;;;;;;oDACjD,UAAU,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,oBAC/B,6LAAC;4DAAiB,WAAU;;8EAC1B,6LAAC;oEAAI,WAAU;;sFACb,6LAAC;sFAAQ,IAAI,OAAO;;;;;;wEACnB,IAAI,IAAI,kBAAI,6LAAC;4EAAK,WAAU;;gFAAsB;gFAAO,IAAI,IAAI;gFAAC;;;;;;;;;;;;;8EAErE,6LAAC;oEAAI,WAAU;;wEAAqC;wEAChD,IAAI,OAAO;wEAAC;;;;;;;;2DANR,IAAI,EAAE;;;;;;;;;;;;;;;;wCAevB,2BACC,6LAAC,uMAAM,CAAC,GAAG;4CACT,SAAS;gDAAE,SAAS;4CAAE;4CACtB,SAAS;gDAAE,SAAS;4CAAE;4CACtB,WAAU;sDAEV,cAAA,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;oDAAI,WAAU;;sEACb,6LAAC,0MAAG;4DAAC,WAAU;;;;;;sEACf,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAI,WAAU;;;;;;8EACf,6LAAC;oEAAI,WAAU;oEAAkD,OAAO;wEAAE,gBAAgB;oEAAO;;;;;;8EACjG,6LAAC;oEAAI,WAAU;oEAAkD,OAAO;wEAAE,gBAAgB;oEAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAS7G,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,KAAK;gDACL,MAAK;gDACL,OAAO;gDACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;gDAC/C,YAAY;gDACZ,aAAY;gDACZ,WAAU;gDACV,UAAU;;;;;;0DAEZ,6LAAC,uMAAM,CAAC,MAAM;gDACZ,YAAY;oDAAE,OAAO;gDAAK;gDAC1B,UAAU;oDAAE,OAAO;gDAAK;gDACxB,SAAS;gDACT,UAAU,CAAC,aAAa,IAAI,MAAM;gDAClC,WAAU;0DAEV,cAAA,6LAAC,6MAAI;oDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAU9B,6LAAC,+MAAe;0BACb,kCACC,6LAAC,uMAAM,CAAC,GAAG;oBACT,SAAS;wBAAE,SAAS;oBAAE;oBACtB,SAAS;wBAAE,SAAS;oBAAE;oBACtB,MAAM;wBAAE,SAAS;oBAAE;oBACnB,WAAU;oBACV,SAAS,IAAM,oBAAoB;8BAEnC,cAAA,6LAAC,uMAAM,CAAC,GAAG;wBACT,SAAS;4BAAE,OAAO;4BAAK,SAAS;wBAAE;wBAClC,SAAS;4BAAE,OAAO;4BAAG,SAAS;wBAAE;wBAChC,MAAM;4BAAE,OAAO;4BAAK,SAAS;wBAAE;wBAC/B,WAAU;wBACV,SAAS,CAAC,IAAM,EAAE,eAAe;;0CAEjC,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAG,WAAU;kDAAsC;;;;;;kDACpD,6LAAC;wCACC,SAAS,IAAM,oBAAoB;wCACnC,WAAU;kDAEV,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAIjB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC;gDAAM,WAAU;;oDAA+C;oDACrC;oDAAW;;;;;;;0DAEtC,6LAAC;gDACC,MAAK;gDACL,KAAI;gDACJ,KAAK;gDACL,OAAO;gDACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;gDAC5C,YAAY;gDACZ,WAAU;gDACV,aAAa,AAAC,KAAe,OAAX;gDAClB,SAAS;;;;;;;;;;;;kDAIb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,SAAS,IAAM,oBAAoB;gDACnC,WAAU;0DACX;;;;;;0DAGD,6LAAC;gDACC,SAAS;gDACT,UAAU,CAAC,aAAa,SAAS,aAAa,KAAK,SAAS,aAAa;gDACzE,WAAU;0DACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWnB;GA/+BwB;MAAA","debugId":null}}]
}